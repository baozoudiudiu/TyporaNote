[toc]

# 变量

2020-07-17 11:04 更新

变量是一个引用，根据Dart中“万物皆对象”原则，即变量存储的都是对象的引用，或者说它们都是指向对象.

## 声明变量

声明可以有两种方式，一种是不指定类型，即使用var关键字

```dart
var name = 'Bob';
```

另一种是明确指定类型（Optional types）

```dart
String name = 'Bob';
```

因为有类型推导，所以两种实现效果一样，官方推荐在函数内的本地变量尽量使用var声明。

在变量类型并不明确的情况下，可以使用dynamic关键字

```dart
dynamic name = 'Bob';
```

## 默认值

未初始化的变量默认值是 null。即使变量是数字类型默认值也是 null，因为在 Dart 中一切都是对象，数字类型也不例外。

```
int lineCount;assert(lineCount == null);
```

提示： 在生产环境代码中 assert() 函数会被忽略，不会被调用。 在开发过程中, assert(condition) 会在非 true 的条件下抛出异常。

## Final 和 Const

使用过程中从来不会被修改的变量， 可以使用 final 或 const，而不是 var 或者其他类型，Final 变量的值只能被设置一次； Const 变量在编译时就已经固定 (Const 变量 是隐式 Final 的类型) 。最高级 final 变量或类变量在第一次使用时被初始化。

提示： 实例变量可以是 final 类型但不能是 const 类型。 必须在构造函数体执行之前初始化 final 实例变量 —— 在变量声明中，参数构造函数中或构造函数的初始化列表中进行初始化。

创建和设置一个 Final 变量：

```dart
final name = 'Bob'; // Without a type annotationfinal String nickname = 'Bobby';
```

final 不能被修改:

```dart
name = 'Alice'; // Error: 一个 final 变量只能被设置一次。
```

如果需要在编译时就固定变量的值，可以使用 const 类型变量。 如果 Const 变量是类级别的，需要标记为 static const。 在这些地方可以使用在编译时就已经固定不变的值，字面量的数字和字符串， 固定的变量，或者是用于计算的固定数字：

```dart
const bar = 1000000; // 压力单位 (dynes/cm2)const double atm = 1.01325 * bar; // 标准气压
```

Const 关键字不仅可以用于声明常量变量。 还可以用来创建常量值，以及声明创建常量值的构造函数。任何变量都可以拥有常量值。

```dart
var foo = const [];final bar = const [];const baz = []; // Equivalent to `const []`
```

声明 const 的初始化表达式中 const 可以被省略。

非 Final，非 const 的变量是可以被修改的，即使这些变量曾经引用过 const 值。

```dart
foo = [1, 2, 3]; // 曾经引用过 const [] 常量值。
```

Const 变量的值不可以修改：

```dart
baz = [42]; // Error: 常量变量不能赋值修改。
```

